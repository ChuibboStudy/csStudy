<!-- TOC -->

* [서비스를 운영하면 모니터링을 해야할 일이 많은데 어떤 툴들을 사용해볼 수 있을까요?](#서비스를-운영하면-모니터링을-해야할-일이-많은데-어떤-툴들을-사용해볼-수-있을까요)
* [`Pinpoint`, `Newrelic`, `Datadog` 같은 APM 툴들은 한 요청에 대한 매우 세밀한 트래킹을 제공합니다. 어떤 원리로 구현한걸까요?](#pinpoint-newrelic-datadog-같은-apm-툴들은-한-요청에-대한-매우-세밀한-트래킹을-제공합니다-어떤-원리로-구현한걸까요)
* [APM툴을 쓸때 JVM의 `javaagent`라는 옵션을 사용하는데 이것은 무엇일까요?](#apm툴을-쓸때-jvm의-javaagent라는-옵션을-사용하는데-이것은-무엇일까요)
* [Java Bytecode Instrumentaion이란 무엇일까요?](#java-bytecode-instrumentaion이란-무엇일까요)
* [이 기술에서 자바의 바이트코드를 순회하기 위해 어떤 디자인 패턴을 사용할까요?](#이-기술에서-자바의-바이트코드를-순회하기-위해-어떤-디자인-패턴을-사용할까요)
* [`JMX` 란 무엇일까요?](#jmx-란-무엇일까요)
* [JMX를 활용하여 모니터링 할 수 있는 도구는 무엇무엇이 있을까요?](#jmx를-활용하여-모니터링-할-수-있는-도구는-무엇무엇이-있을까요)

<!-- TOC -->

# 서비스를 운영하면 모니터링을 해야할 일이 많은데 어떤 툴들을 사용해볼 수 있을까요?

- `Jconsole`: Java 애플리케이션의 기본 성능 및 리소스 모니터링을 위한 Java Development Kit(JDK)에 내장된 도구입니다.
- `VisualVM`: 또한 JDK의 일부로 CPU, 메모리 및 스레드 분석을 포함한 보다 상세한 모니터링 및 프로파일링 기능을 제공합니다.
- `프로메테우스와 그라파나`: 고급 모니터링 및 시각화를 위한 오픈 소스 조합. 프로메테우스는 메트릭을 수집하고 그라파나는 상세 대시보드를 만듭니다.

- `Jconsole`은 간단하고 빠른 검사에 적합합니다. 자바 애플리케이션의 상태를 모니터링하는 데 필수적인 메모리 사용량, 스레드 활동 및 클래스 로딩에 대한 통찰력을 제공합니다.
- `VisualVM`은 더 깊은 분석을 제공합니다. 애플리케이션 프로파일링, 메모리 및 CPU 사용량 상세 이해, 스레드 상태 분석에 탁월합니다. 특히 VisualVM은 성능 문제를 해결하는 데 유용합니다.
- `프로메테우스와 그라파나`는 확장 가능한 장기 모니터링에 이상적입니다. 프로메테우스의 강력한 쿼리 언어를 통해 정확한 메트릭 수집이 가능하며, 그라파나의 맞춤형 대시보드를 통해 이러한 메트릭을 효과적으로
  시각화하고 해석할 수 있습니다. 이 조합은 특히 복잡하고 분산된 시스템을 모니터링하는 데 유용합니다.

# `Pinpoint`, `Newrelic`, `Datadog` 같은 APM 툴들은 한 요청에 대한 매우 세밀한 트래킹을 제공합니다. 어떤 원리로 구현한걸까요?

`Pinpoint`, `New Relic` 및 `Datadog`과 같은 APM(애플리케이션 성능 관리) 도구는 주로 다음 원칙을 기반으로 개별 요청을 세부적으로 추적합니다.

1. `계측화` : APM 도구는 자동으로 코드를 계측하거나 수동 계측을 사용하여 자세한 정보를 수집합니다. 여기에는 애플리케이션에 모니터링 코드를 삽입하여 각 요청에 대한 데이터를 수집하는 작업이 포함됩니다.
   메소드 호출, 응답 시간 및 기타 측정항목을 추적합니다.
2. `분산 추적` : 요청이 마이크로서비스 아키텍처의 다양한 서비스를 통해 이동할 때 요청을 따르도록 분산 추적을 구현합니다. 이는 복잡한 분산 시스템에서 요청이 처리되는 방식을 이해하는 데 중요합니다.
3. `실시간 데이터 수집 및 분석` : 이 도구는 실시간으로 데이터를 수집하고 분석합니다. 이를 통해 애플리케이션 성능과 사용자 경험에 대한 즉각적인 통찰력을 제공할 수 있습니다.
4. `이상 탐지 및 경고` : APM 도구는 알고리즘을 사용하여 애플리케이션 성능의 이상을 탐지합니다. 미리 정의된 임계값이나 데이터에서 감지된 비정상적인 패턴을 기반으로 경고를 트리거할 수 있습니다.
5. `사용자 중심 모니터링` : 여기에는 사용자 상호 작용을 추적 및 분석하여 사용자 경험과 백엔드 성능이 사용자 경험에 미치는 영향에 대한 통찰력을 제공하는 기능이 포함되는 경우가 많습니다.
6. `시각화 및 보고` : 이 도구는 대시보드 및 보고 기능을 제공합니다.

# APM툴을 쓸때 JVM의 `javaagent`라는 옵션을 사용하는데 이것은 무엇일까요?

JVM의 `javaagent` 옵션은 JVM에 에이전트를 연결하는 데 사용됩니다. 에이전트는 소스 코드를 수정하지 않고도 실행 중에 바이트코드를 수정하고, 모니터링하고, 애플리케이션에 대한 자세한 정보를 수집할 수
있습니다.

JVM(Java Virtual Machine)의 `javaagent` 옵션은 런타임 시 Java 애플리케이션을 계측하는 데 사용되는 강력한 기능입니다. 주요 측면에 대한 분석은 다음과 같습니다.

1. `바이트코드 계측`: `javaagent`는 Java 계측 API를 사용하여 클래스가 JVM에 로드될 때 클래스의 바이트코드를 수정합니다.
   이를 통해 애플리케이션의 소스 코드를 변경하지 않고도 런타임 시 애플리케이션 동작을 모니터링하고 수정할 수 있습니다.
2. `구현`: `javaagent`는 에이전트 클래스를 지정하는 특별한 매니페스트 속성을 포함하는 JAR 파일로 구현됩니다.
   이 클래스는 JVM이 애플리케이션의 기본 메소드보다 먼저 호출하는 premain 메소드를 구현해야 합니다.
3. `APM 도구에서 사용`: APM(애플리케이션 성능 관리) 도구의 컨텍스트에서 `javaagent`는 애플리케이션에 모니터링 코드를 삽입하는 데 사용됩니다. 이 삽입된 코드는 메소드 실행 시간, 예외 처리 등과
   같은 다양한 측정항목을 추적하여 애플리케이션의 성능과 동작에 대한 통찰력을 제공합니다.
4. `동적 연결`: Javaagent는 일반적으로 시작 시 JVM 인수로 지정되지만 일부 도구는 실행 중인 JVM 프로세스에 대한 동적 연결도 지원하므로 애플리케이션을 다시 시작하지 않고도 모니터링이 가능합니다.
5. `성능에 미치는 영향 최소화`: Javaagent는 애플리케이션 성능에 최소한의 영향을 미치도록 설계되어 프로덕션 환경에서 사용하기에 적합합니다.

# Java Bytecode Instrumentaion이란 무엇일까요?

소스 코드를 변경하지 않고 프로그램의 동작을 변경하기 위해 런타임 시 Java 클래스 파일의 바이트코드를 수정하는 프로세스입니다.

- `정의`: Java의 BCI(바이트코드 계측)는 JVM(Java Virtual Machine)에서 실행되기 전 Java 코드의 중간 표현인 Java 바이트코드를 수정하는 프로세스를 의미합니다. 이 수정은 런타임에
  발생합니다.
- `목적`: 주로 성능 모니터링, 프로파일링, 로깅, 디버깅 및 테스트에 사용됩니다. APM 도구는 이를 사용하여 애플리케이션에 모니터링 코드를 삽입합니다.
- `메커니즘`: BCI는 에이전트가 클래스 로더에 의해 로드되는 클래스를 가로채고 변환할 수 있도록 하는 Java의 계측 API를 사용하여 달성할 수 있습니다.
  수정은 비침습적입니다. 즉, 소스 코드가 변경되지 않은 상태로 유지됩니다.
- `애플리케이션`: 이 기술은 프로파일러, 디버거, APM 솔루션과 같은 도구에서 런타임 시 애플리케이션 동작에 대한 데이터를 수집하는 데 널리 사용됩니다.

# 이 기술에서 자바의 바이트코드를 순회하기 위해 어떤 디자인 패턴을 사용할까요?

- 패턴 선택: 방문자 패턴은 기존 객체 구조를 수정하지 않고도 새로운 작업을 추가할 수 있는 디자인 패턴입니다. Java 바이트코드는 다양한 작업이 필요할 수 있는 복잡한 구조이기 때문에 바이트코드 조작에
  적합합니다.
- 작동 방식: 바이트코드 계측에서 방문자 패턴에는 바이트코드 구조를 순회할 수 있는 '방문자' 클래스 생성이 포함됩니다. 메소드, 필드, 명령어와 같은 다양한 요소를 방문하면서 명령어 추가, 수정 또는 제거와 같은
  특정 작업을 수행합니다.
- 장점: 이 패턴은 알고리즘을 개체 구조에서 분리하여 깔끔하고 유지 관리 가능한 코드를 촉진하므로 유용합니다. 작업하는 요소의 클래스를 변경하지 않고도 새로운 작업을 추가할 수 있습니다.

# `JMX` 란 무엇일까요?

`JMX`는 Java 애플리케이션과 서비스를 관리하고 모니터링하기 위한 표준 방법을 제공하는 Java 기술입니다. 개발자는 JMX를 사용하여 자신의 애플리케이션을 모니터링 및 관리 시스템과 통합할 수 있습니다.
JMX는 MBeans(관리되는 빈)라고 하는 객체를 사용하여 애플리케이션에서 데이터와 작업을 외부로 노출합니다. 이 MBeans는 Java 가상 머신(JVM) 내의 관리 에이전트 역할을 하는 MBean 서버에
등록됩니다.
JMX를 통해 메모리, 쓰레드, 서비스 등의 애플리케이션 리소스를 모니터링하고 관리할 수 있으며, 특히 구성 조정, 성능 통계 수집 및 문제 해결에 유용합니다.

# JMX를 활용하여 모니터링 할 수 있는 도구는 무엇무엇이 있을까요?

- `JConsole` : Java 개발 키트(JDK)에 포함된 그래픽 모니터링 도구로, JVM의 MBean 서버에 연결합니다. 메모리 사용량, 쓰레드 통계, 클래스 로딩 등의 정보를 제공합니다.
- `VisualVM` : JDK의 일부인 VisualVM은 Java 프로세스에 연결하여 MBeans에 접근할 수 있어, 메모리 및 CPU 프로파일링, 힙 분석 등 더 깊은 모니터링과 관리를 제공합니다.
- `Nagios` : JMX와 플러그인을 사용하여 통합할 수 있는 오픈 소스 모니터링 도구로, Java 애플리케이션을 다른 시스템 리소스와 함께 모니터링할 수 있습니다.
- `Zabbix` : 또 다른 오픈 소스 모니터링 도구로 JMX 통합이 가능합니다. Java 애플리케이션의 성능 및 가용성을 모니터링할 수 있습니다.
- `Datadog 및 New Relic` : 보다 고급 상업용 모니터링 플랫폼으로 JMX 통합을 제공합니다. Java 애플리케이션에 대한 자세한 인사이트, 대시보드 및 알림 기능을 제공합니다.
